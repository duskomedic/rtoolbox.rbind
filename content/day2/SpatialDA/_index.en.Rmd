---
date: "2016-04-09T16:50:16+02:00"
title: Analiza geo-pozicioniranih podataka
weight: 3
---

R sadrÅ¾i spektar paketa koji vam obezbeÄ‘uju upravljanje sa geo-pozicioniranim podacima i set oparaciju za njihovu analizu. Analiza geo-pozicioniranih podataka nije viÅ¡e dostupna jedino ekspertima koji su radili na skupim kompjuterima i skupim softverima. R ima impresivne geografske sposobnosti koje su dostupne svima onima koji Å¾ele da ih istraÅ¾uju. 

Pre nego Å¡to uÄ‘emo dublje u geo-prostorno mapiranje u R-u, upoznajmo se sa osnovnim idejama ovakve vrste podataka.

Prostorni podaci sastoje se od:

- Koordinata objekta
- Koordinata povezanih fiziÄkih lokacija na Planeti: koordinatni refentni sistem: **coordinate reference system** (**CRS**)

Postoje **dva tipa CRS-a**:

1) Geografski

  * SpecifiÄne lokacije na povrÅ¡ini definisane su sa tri dimenzije na modelu Zemlje. 
  * Longitudinalni i lateralni

2) Projektovani

  *	Konverzija trodimenzionalne mreÅ¾e na dvodimenzionalnu povrÅ¡inu.

Prema tehnici njihovog Äuvanja, prostorni podaci su jedna od sledeÄ‡e dve vrste:

1)	**Rasterski podaci**: sastavljeni od mreÅ¾e Ä‡elija koje su indentifikovane redom i kolonom. Celina geografskog podruÄja podeljena je u grupe individualnih Ä‡elija, koje predstavljaju sliku (satelitske slike)

2)	**Vektorski podaci** sastavljeni su od taÄaka, linija i poligona. Na primer bolnice, kuÄ‡e itd. predstavljene su taÄkama, dok su reke, putevi, itd, predstavljene su linijama. Sela i gradovi su predstavljeni poligonima.

Kada radite analizu prostornih podataka takoÄ‘e Ä‡ete raditi i sa kategoriÄkim podacima koji sadrÅ¾e relevantne informacija o prostornim podacima. Analize Ä‡e se raditi na kategoriÄkim podacima koji su povezani sa geo-prostornim. Ovakvi podaci mogu biti:

* nominal
* ordinal
* podaci raspona (interval data)
* podaci o odnosu (ratio data),

tj. kategoriÄki ili merljivi tip podataka.

**StatiÄke mape: fajl oblika** 

R poseduje impresivne geografske kapacitete i moÅ¾e da obraÄ‘uje fajlove razliÄitih vrsta prostornih podataka ukljuÄujuÄ‡i geojson i KML. IlustrovaÄ‡emo upotrebu ESRI (shapefile) fajlova formata, koji Äuvaju netopoloÅ¡ku geometiju i kategoriÄke informacije za prostorne odlike u setu podataka. Ovi podaci sastavljeni su od glavnog fajla, index fajla i dBASE tabele.

-	.shp - lista oblika i vrhova
-	.shx - sadrÅ¾i indeks sa odstupanjima
-	.dbf - fajl odnosa izmeÄ‘u geometrije i kategoriÄkih podataka

Da biste pravilno uvezli datoteku ESRI oblika u R, sve tri datoteke moraju biti prisutne u direktorijumu i moraju imatu isto ime (osim nastavka koji se odnosi na tip fajla).

ZapoÄnimo Äitanje datoteke oblika regiona Srbije koja je dostupna na [GADM maps and data](https://gadm.org/download_country_v3.html).

Prvo, preuzmite fajlove koji su nam portrebni sa sledeÄ‡eg GitHub repozitorija: <https://github.com/TanjaKec/gadm36_SRB_shp>. Obavezno saÄuvajte fajl u radni direktorijum svoga R-projekta pre nego Å¡to zatraÅ¾ite od R da izvrÅ¡i sledeÄ‡i kod:

```
## If you don't have sf installed yet, uncomment and run the line below
#install.packeges("sf")

library(ggplot2)
library(sf)

#pointed to the shape file
serbia_location <- "gadm36_SRB_1.shp"

#used the st_read() function to import it
serbia_districts <- st_read(serbia_location)

# take a look at the file
View(serbia_districts)

# plot the disstricts 
ggplot(serbia_districts) + 
  geom_sf()
```

![](/day2/SpatialDA/images/serbia.png?width=40pc)

Ovo dobro izgleda ğŸ˜ƒ SledeÄ‡e, Å¡to Å¾elimo da dodamo podatke i da ih â€obojimoâ€œ. DodaÄ‡emo podatke o broju stanovnika u Srbiji u 2017. godini koji su nam dostupni u datom fajlu â€œSerbian_Pop.csvâ€ file.  

```
population <- read.csv("Serbian_Pop.csv")
View(population)

library(dplyr)

serbia_pop <- left_join(serbia_districts, population,
                          by=c("NAME_1" = "District"))

View(serbia_pop)


ncol(serbia_districts)

ncol(population)

ncol(serbia_pop)

names(serbia_pop)


ggplot(serbia_pop) +
  geom_sf(aes(fill=total_pop)) +
  scale_fill_distiller(direction = 1, name = "Population") +
  labs(title="Population of Serbia for 2017", caption="Source: Statisticki Zavod SR")
```

![](/day2/SpatialDA/images/SR_pop_2017.png?width=40pc)

Ponekad biste moÅ¾da Å¾eleli da predstavite regione kao skup Äestica na viÅ¡e ploÄa. Zapamtite, ovo moÅ¾ete uraditi i upotrebom `facet` funkcije `ggplot` biblioteke.

```
ggplot(serbia_pop) +
  geom_sf(aes(fill = total_pop)) +
  scale_fill_distiller(direction = 1, name = "Population") +
  labs(title="Population of Serbia for 2017", caption="Source: Statisticki Zavod SR") +
  facet_wrap(~NAME_1)
```

![](/day2/SpatialDA/images/facet_sr.png?width=40pc)

**Interaktivne mape: letak**

`Leaflet` je jedan od najpopularnijih JavaScript biblioteka za interktivne mape koje su integrisane u R, zahvaljuÄ‡i grupi ljudu okupljenih oko Rstudija. IlustrovaÄ‡emo kako je jednostavno da se iscrta lokacijska mapa upotrebom leaflet paketa, ali potrebno je prethodno da nauÄine viÅ¡e o ovom paketu sa stranice [Leaflet for R](https://rstudio.github.io/leaflet/).

```{r}
## If you don't have leaflet installed yet, uncomment and run the line below
#install.packeges("leaflet")
library(leaflet)
# Initialize and assign us as the leaflet object
us <- leaflet() %>%
  # add tiles to the leaflet object
  addTiles() %>%  
  # setting the centre of the map and the zoom level
  setView(lng = 21.43667, lat = 41.99578, zoom = 15) %>% 
  # add a popup marker 
  addMarkers(lng = 21.43551, lat = 41.99405, popup = "<b>Ciao!</b><br><a href='http://balkansmedia.org/innovation-lab/2nd-media-innovation-lab-master-classes-and-presentations'>2nd Media Innovation Lab! ğŸ˜€</a>")

us
```

Pogledajte zanimljivu veb stranicu koja vas upoznaje sa svim moguÄ‡nostima kreiranja mapa sa ['leaflet'](https://maptimeboston.github.io/leaflet-intro/). Dobro je pregledajte i istraÅ¾ite.

{{% notice note %}}
Od svoje orginalne primene statistiÄkog programskog jezika, R je preÅ¡ao dug put i postao vrlo moÄ‡an u podrÅ¡ci prostornih analiza. Svi R paketi ukljuÄuju vinjete sa objaÅ¡njenjima sintakse funkcija i Äesto veoma korisnim mini-tutorijalima koji ilustruju praktiÄnu upotrebu funkciju na neki zadat problem. [CRAN Task View for Analysis of Spatial Data ](https://cran.r-project.org/web/views/Spatial.html) obezbeÄ‘uje vam listu dostupnih biblioteka R-u za geografsko mapiranje koje se Äesto koriste u prostornim analizama i projektima mapiranja. 
{{% /notice %}}


**ZADACI ğŸ‘‡**

VeÅ¾bajte na sledeÄ‡em setu zadataka:

1)	ProÄitajte datoteku okruga u Srbiji na osnovu [GADM maps and data](https://gadm.org/download_country_v3.html) i iscrtajte broj stanovnika po kvadratnom kilometru, podacima dostupnim u â€˜Serbian_Pop.csvâ€™ koje smo veÄ‡ koristili ranije.

2)	Napravite mapu koja Ä‡e oznaÄavati vaÅ¡e omiljeno mesto za druÅ¾enje upotrebom leaflet paketa.



**Korisni linkovi:** 

[R for the analysis of spatial or spatio-temporal data (blog)](https://www.r-spatial.org/)

[Geocomputation with R](https://geocompr.robinlovelace.net/): knjiga o analizi geografskih podataka, vizuelizaciji i modelovanju.

[GADM maps and data](https://gadm.org/download_country_v3.html)

[Creating Interactive Spatial Maps in R Using Leaflet](https://www.earthdatascience.org/courses/earth-analytics/get-data-using-apis/leaflet-r/)

[Thematic Mapping with tmap](https://map-rfun.library.duke.edu/031_thematic_mapping.html)

-----------------------------
Â© 2019 Tatjana Kecojevic
